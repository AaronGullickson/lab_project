model <- lm(BoxOffice~I(Runtime-80), data=movies)
coef(model)
13/15
12/15
model <- lm(age~fare, data=titanic)
summary(model)
load("~/Teaching/Classes/SOC312/ExampleDatasets/crimes.RData")
summary(lm(PctMale))
summary(lm(PctMale~Violent, data=crimes))
load("~/Teaching/Classes/SOC312/ExampleDatasets/movies.RData")
mean(movies$Year)
mean(movies$Year)
sd(movies$Year)
mean(movies$Year)
sd(movies$Year)
source('~/.active-rstudio-document', echo=TRUE)
mean(movies$BoxOffice)
sd(movies$Year)
coef(lm(BoxOffice~Year, data=movies))
coef(lm(Year~BoxOffice, data=movies))
round(coef(lm(Year~BoxOffice, data=movies)),5)
cor(movies$BoxOffice, movies$Year)
cor(movies$Year, movies$BoxOffice)
boxplot(movies$BoxOffice~movies$Rating)
boxplot(movies$Rating~movies$BoxOffice)
sqrt(0.4*(1-0.4)/5834)
0.4-1.960371*0.0064
0.4+1.960371*0.0064
x <- c(3.8,3.4,3.6,2.2,3.2,3.0,4.8,3.2,2.8,3.8
)
x
sd(x)
x <- c(3.4,2.2,3.4,3.4,3.2,2.4,1.8,4.6,4.8,5.2)
sd(x)
x <- c(4.5,4.5,4.5,3.5,4,5.5,4.5,3.5,4)
mean(x)
sd(x)
load("~/Teaching/Classes/SOC312/ExampleDatasets/crimes.RData")
load("~/Teaching/Classes/SOC312/ExampleDatasets/movies.RData")
load("~/Teaching/Classes/SOC312/ExampleDatasets/sex.RData")
model <- lm(sexf~educ, data=sex)
coef(model)
model <- lm(Property~Poverty, data=crimes)
coef(model)
coef(lm(Violent~Unemployment, data=crimes))
coef(lm(Violent~PctLessHS, data=crimes))
coef(lm(Violent~Unemployment+PctLessHS, data=crimes))
coef(lm(sexf~relig, data=sex))
coef(lm(sexf~reli+educg, data=sex))
coef(lm(sexf~relig+educ, data=sex))
coef(lm(income~educ+age, data=politics))
load("~/Teaching/Classes/SOC312/ExampleDatasets/politics.RData")
coef(lm(income~educ+age, data=politics))
model <- lm(sexf~educ*gender, data=sex)
coef(model)
model <- lm(sexf~I(educ-12)*gender, data=sex)
coef(model)
-0.34+0.66
load("~/Teaching/Classes/SOC312/ExampleDatasets/sex.RData")
load("~/Teaching/Classes/SOC312/ExampleDatasets/movies.RData")
load("~/Teaching/Classes/SOC312/ExampleDatasets/crimes.RData")
load("~/Teaching/Classes/SOC312/ExampleDatasets/titanic.RData")
load("~/Teaching/Classes/SOC312/ExampleDatasets/politics.RData")
model <- lm(income~age, data=politics)
summary(model)$coef
nrow(politics)
pt(.975, 5914-2)
qt(.975, 5914-2)
model <- lm(income~age, data=politics)
summary(model)$coef
nrow(politics)
qt(.975, 5914-2)
0.161-0.045*1.960365
0.161+0.045*1.960365
mean(sex$age)
xbar <- mean(sex$age)
s <- sd(sex$age)
n <- nrow(sex)
se <- s/sqrt(n)
qt(.975, n-1)
tstat <- qt(.975, n-1)
xbar - tstat*se
xbar + tstat*se
tab <- table(sex$relig)
tab
n <- sum(tab)
prop <- 507/n
prop
se <- sqrt(prop*(1-prop)/n)
t <- qt(.975,n-1)
prop-t*se
prop+t*se
tab <- table(politics$party)
tab
n <- sum(tab)
prop <- 2361/n
prop
se <- sqrt(prop*(1-prop)/n)
se
t <- qt(.975,n-1)
t
prop-t*se
prop+t*se
runtime.sample <- sample(movies$Runtime, 100, replace=FALSE)
length(runtime.sample)
xbar <- mean(sex$educ)
s <- sd(sex$educ)
n <- nrow(sex)
se <- s/sqrt(n)
qt(.975, n-1)
tstat <- qt(.975, n-1)
xbar - tstat*se
xbar + tstat*se
tab
tab <- politics$relig
sum(tab)
tab
tab <- table(politics$relig)
sum(tab)
tab
760+2071+1377+110+253+1257
tab <- table(sex$relig)
tab
n <- sum(tab)
prop <- 507/n
prop
se <- sqrt(prop*(1-prop)/n)
t <- qt(.975,n-1)
prop-t*se
prop+t*se
head(politics)
tapply(politics$age, politics$globalwarm, mean, na.rm=TRUE)
x <- tapply(politics$age, politics$globalwarm, mean, na.rm=TRUE)
x
meandiff <- diff(x)
meandiff
means <- tapply(politics$age, politics$globalwarm, mean, na.rm=TRUE)
means
meandiff <- diff(means)
sd <- tapply(politics$age, politics$globalwarm, sd, na.rm=TRUE)
sd
table(politics$globalwarm)
SE <- sqrt(16.79025^2/1765+16.75115^2/4007)
se
SE
tstat <- meandiff/SE
tstat
pt(tstat, 1765-1)
prop.table(table(politics$relig, politics$party),1)
prop.table(table(politics$relig, politics$party),1)
prop.table(table(politics$relig, politics$party),2)
propdiff <- 0.20359281-0.13018182
propdiff
table(politics$party)
prop.table(table(politics$relig, politics$party),2)
pd <- 0.20359281
pr <- 0.13018182
propdiff <- pd-pr
propdiff
table(politics$party)
SE <- sqrt(pd*(1-pd)/2361+pr*(1-pr)/1389)
SE
tstat <- propdiff/SE
tstat
pt(-tstat,1389-1)
tapply(sex$sexf, sex$relig, mean)
meandiff <- 59.84862-49.59892
meandiff
tapply(sex$sexf, sex$relig, sd)
table(sex$relig)
SE <- sqrt(57.94731^2/327+52.84669^2/556)
SE
tstat <- meandiff/SE
pt(-tstat, 327-1)
tstat
tapply(politics$income, politics$party, mean, na.rm=TRUE)
2*pt(-tstat, 327-1)
2*pt(-tstat,1389-1)
2*pt(-5.990034,1389-1)
2*pt(-21.66985, 1765-1)
2*pt(-2.166985, 1765-1)
sqrt(53.29445^2/2154+71.25765^2/1307)
sex$sexeduc <- as.numerica(sex$sexfreq)-1
model <- lm(sexeduc~sexf, data=sex)
sex$sexeduc <- as.numerical(sex$sexfreq)-1
model <- lm(sexeduc~sexf, data=sex)
sex$sexeduc <- as.numeric(sex$sexfreq)-1
model <- lm(sexeduc~sexf, data=sex)
summary(model)
sex$sexeduc <- as.numeric(sex$sexfreq)-1
model <- lm(sexeduc~sexf, data=sex)
summary(model)$coef
sqrt((0.1302(1-0.1302))/1389+(0.2036(1-0.2036)/2361))
sqrt((0.1302)*(1-0.1302))/1389+(0.2036)*(1-0.2036)/2361))
sqrt((0.1302)*(1-0.1302)/1389+(0.2036)*(1-0.2036)/2361)
tapply(sex$sexf, sex$relig, sd)
SE <- sqrt(57.94731^2/327+49.58294^2/556)
SE
table(sex$relig)
SE <- sqrt(57.94731^2/327+49.58294^2/529)
SE
sqrt(57.95^2/327 + 49.58^2/529)
tapply(sex$sexf, sex$relig, mean)
load("~/Teaching/Classes/SOC312/ExampleDatasets/crimes.RData")
summary(lm(Property~Poverty, data=crimes))
summary(lm(Property~Gini, data=crimes))
summary(lm(Property~Poverty+Gini, data=crimes))
97.5/109
load("~/Teaching/Classes/SOC312/ExampleDatasets/crimes.RData")
summary(lm())
load("~/Teaching/Classes/SOC312/ExampleDatasets/movies.RData")
summary(lm(Runtime~TomatoMeter, data=movies))
summary(lm(Runtime~TomatoRating, data=movies))
summary(lm(Poverty~Property, data=crimes))
summary(lm(Poverty~Violent, data=crimes))
summary(lm(Poverty~Property, data=crimes))
summary(lm(Poverty~Property+Gini, data=crimes))
summary(lm(Property~Poverty+Gini, data=crimes))
summary(lm(Gini~Property+Poverty, data=crimes))
load("~/Teaching/Classes/SOC312/ExampleDatasets/crimes.RData")
load("~/Teaching/Classes/SOC312/ExampleDatasets/movies.RData")
hist(movies$Runtime)
hist(movies$Runtime, col="skyblue", xlab="runtime in minutes", ylab="frequency", las=1)
hist(movies$Runtime, col="skyblue", xlab="runtime in minutes", ylab="frequency", las=1, main="")
install.packages("stargazer")
library("stargazer", lib.loc="/Library/Frameworks/R.framework/Versions/3.3/Resources/library")
library(stargazer)
model1 <- lm(TomatoMeter~Runtime, data=movies)
model2 <- lm(TomatoMeter~Runtime+Rating, data=movies)
View(movies)
model3 <- lm(TomatoMeter~Runtime+Rating+Year, data=movies)
summary(model1)
summary(model2)
summary(model3)
stargazer(model1, model2, model3)
?stargazer
stargazer(model1, model2, model3, type="text")
stargazer(model1, model2, model3, type="text",keep.stat=c("n","rsq"))
hist(movies$Runtime)
hist(movies$Runtime, col="skyblue")
hist(movies$Runtime, col="skyblue", xlab="runtime in minutes", ylab="frequency", las=1)
hist(movies$Runtime, col="skyblue", xlab="runtime in minutes", ylab="frequency", las=1, main="")
install.packages("Stargazer")
install.packages("stargazer")
detach("package:stargazer", unload=TRUE)
library("stargazer", lib.loc="/Library/Frameworks/R.framework/Versions/3.3/Resources/library")
library(stargazer)
model1 <- lm(TomatoMeter~Runtime, data=movies)
model2 <- lm(TomatoMeter~Runtime+Rating, data=movies)
model3 <- lm(TomatoMeter~Runtime+Rating+Year, data=movies)
stargazer(model1, model2, model3, type="text")
stargazer(model1, model2, model3, type="text", keep.stat=c("n","rsq"))
stargazer(model1, model2, model3, type="text", keep.stat=c("n","rsq"),)
stargazer(model1, model2, model3, type="text", keep.stat=c("n","rsq"), covariate.labels = c("runtime (minutes)", "PG","PG-13","R","NC-17","Unrated","year of release"))
stargazer(model1, model2, model3, type="text", keep.stat=c("n","rsq"), covariate.labels = c("Runtime (minutes)", "PG","PG-13","R","NC-17","Unrated","Year of release"), dep.var.labels = "Tomato Meter")
stargazer(model1, model2, model3, type="html", keep.stat=c("n","rsq"), covariate.labels = c("Runtime (minutes)", "PG","PG-13","R","NC-17","Unrated","Year of release"), dep.var.labels = "Tomato Meter")
stargazer(model1, model2, model3, type="html", keep.stat=c("n","rsq"), covariate.labels = c("Runtime (minutes)", "PG","PG-13","R","NC-17","Unrated","Year of release"), dep.var.labels = "Tomato Meter", file="~/Desktop/temp.html")
?stargazer
stargazer(model1, model2, model3, type="html", keep.stat=c("n","rsq"), covariate.labels = c("Runtime (minutes)", "PG","PG-13","R","NC-17","Unrated","Year of release"), dep.var.labels = "Tomato Meter", out ="~/Desktop/temp.html")
load("~/Teaching/Classes/SOC312/ExampleDatasets/politics.RData")
summary(lm(income+educ+age, data=politics))
View(politics)
summary(lm(income+educ+age, data=politics))
summary(lm(income~educ+age, data=politics))
movies <- movies[as.numeric(movies$Rating)<5,]
model <- lm(BoxOffice~Rating*Runtime, data=movies)
round(summary(model)$coef,2)
load("~/Teaching/Classes/SOC312/ResearchProjects/emissions/wdi.RData")
View(wdi)
load("~/Teaching/Classes/SOC312/ResearchProjects/popularity/addhealth.RData")
table(addhealth$smoker)
lm(smoker~indegree, data=addhealth)
lapply(c("R2MLwiN","arm","ggplot2","RColorBrewer","grid"),library, character.only=TRUE)
install.packages("R2MLwiN")
library(R2MLwiN)
lapply(c("R2MLwiN","arm","ggplot2","RColorBrewer","grid"),library, character.only=TRUE)
data(tutorial)
str(tutorial)
# Fit a linear varying intercept multilevel model with group level predictors of normexam ~ sex + standlrt + vrband + schgend + avslrt + schav + (1|school)
fit.1 <-lmer(normexam ~ sex + standlrt + vrband + schgend + avslrt + schav + (1|school), data=tutorial)
display(fit.1)
ranef(fit.1)
ranef <-ranef(fit.1)
ranef.se<-se.ranef(fit.1)
u0mn <-ranef$school
u0se <-ranef.se$school
# Rank residuals
u0rankmn = rank(u0mn)
u0hi <- u0mn + (1.96*u0se)
u0lo <- u0mn  - (1.96*u0se)
# Combine into data.frame
d <-data.frame(u0mn,u0rankmn, u0hi, u0lo)
palette <- brewer.pal("Greys", n=9)
color.background = palette[1]
color.grid.major = palette[5]
color.axis.text = palette[6]
color.axis.title = palette[7]
color.title = palette[9]
k <- ggplot()+
geom_pointrange(data=d,mapping=aes(x=d$u0rankmn, y=d$X.Intercept., ymin=d$X.Intercept..2,ymax=d$X.Intercept..1), position="identity", width=0.5, size=1, color="black")+
theme_bw() +
# Set the entire chart region to a light gray color
theme(panel.background=element_rect(fill=color.background, color=color.background)) +
theme(plot.background=element_rect(fill=color.background, color=color.background)) +
theme(panel.border=element_blank(), axis.line=element_line(), axis.line.y=element_blank()) +
# Format the grid
theme(panel.grid.major=element_line(colour=color.background,size=.75)) +
theme(axis.ticks=element_blank()) +
theme(axis.line.x =element_line(colour="#535353", size=.75))+
theme(axis.line.y =element_line(colour="#535353", size=.75))+
# Dispose of the legend
theme(legend.position="none") +
# Set title and axis labels, and format these and tick marks
ggtitle("Residuals: Intercept")+
theme(plot.title=element_text(face="bold",hjust=-.08,vjust=2,colour="#3C3C3C",size=20)) +
xlab("Rank of residuals") +
ylab("Intercept") +
theme(axis.text.x=element_text(size=17,colour="#535353",face="bold")) +
theme(axis.text.y=element_text(size=17,colour="#535353",face="bold")) +
theme(axis.title.y=element_text(size=17,colour="#535353",face="bold",vjust=1.5)) +
theme(axis.title.x=element_text(size=17,colour="#535353",face="bold",vjust=-.5)) +
# Big bold line at y=0
geom_hline(yintercept=0,size=1.2, alpha=0.7,colour="#EF3B2C", linetype="twodash")+
# Plot margins and finally line annotations
theme(plot.margin = unit(c(1, 1, .5, .7), "cm"))
k
?geom_pointrange
load("~/Teaching/Classes/SOC312/ExampleDatasets/crimes.RData")
2+3
2+3
2+3
2+3
2+3
2+3
View(crimes)
mean(crimes$Property)
round(mean(crimes$Property),2)
load("~/Teaching/Classes/SOC312/ExampleDatasets/movies.RData")
View(movies)
2+3
2+3*5
(2+3)*5
movies$Runtime
mean(movies$Runtime)
table(movies$Rating)
counts <- table(movies$Rating)
counts
sum(counts)
counts/sum(counts)
100*counts/sum(counts)
round(100*counts/sum(counts), 2)
percents <- round(100*counts/sum(counts), 2)
barplot(percents)
barplot(percents, col="yellow", border="darkgreen")
barplot(percents, col="yellow", border="darkgreen", las=1)
barplot(percents, col="yellow", border="darkgreen", las=1, ylab="Percent", xlab="Maturity Rating")
barplot(percents, col="yellow", border="darkgreen", las=1, ylab="Percent", xlab="Maturity Rating", main="Distribution of movie maturity rating")
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
counts <- table(movies$Rating)
percents <- round(100*counts/sum(counts), 2)
barplot(percents, col="yellow", border="darkgreen",
las=1, ylab="Percent", xlab="Maturity Rating",
main="Distribution of movie maturity rating")
source('~/Desktop/Untitled.R', echo=TRUE)
educ <- seq(from=0,to=1,by=.01)
relig <- seq(from=-2,to=2,by=0.05)
y.christian <- 0.515-.116*educ
y.muslim <- 0.515-0.017*relig
plot(educ, y.christian)
plot(educ, y.christian, type="l")
plot(educ, y.christian, type="l", lwd=2, col="red")
y.christian <- -.116*educ
plot(educ, y.christian, type="l", lwd=2, col="red")
plot(educ, y.christian, type="l", lwd=2, col="red", ylim=c(-.4,0.6))
y.muslim <- 0.515-(-0.017-0.126)*relig
lines(educ, y.muslim, lwd=3, col="darkgree")
y.muslim <- 0.515-(-0.017-0.126)*educ
lines(educ, y.muslim, lwd=3, col="darkgree")
lines(educ, y.muslim, lwd=3, col="darkgreen")
y.muslim <- 0.515+(-0.017-0.126)*educ
lines(educ, y.muslim, lwd=3, col="darkgreen")
plot(educ, y.christian, type="l", lwd=2, col="red", ylim=c(-.4,0.6))
lines(educ, y.muslim, lwd=3, col="darkgreen")
y.christian <- -.017*relig
y.muslim <- 0.515+(-0.017+.145)*relig
lines(relig, y.muslim, lwd=3, col="darkgreen")
plot(relig, y.christian, type="l", lwd=2, col="red", ylim=c(-.4,0.6))
lines(relig, y.muslim, lwd=3, col="darkgreen")
plot(relig, y.christian, type="l", lwd=2, col="red", ylim=c(-.4,1))
lines(relig, y.muslim, lwd=3, col="darkgreen")
n <- 3
dice <- 6
matrix(NA, n, dice)
array(NA, c(6,6,6))
?array
6*6*6
rep(1:6, each=6)
rep(rep(1:6, each=6), 6)
array(rep(rep(1:6, each=6), 6), c(6,6,6))
6^3
array(rep(rep(1:6, each=6), 6), c(6,6,6))
x <- array(rep(rep(1:6, each=6), 6), c(6,6,6))
x <- array(rep(rep(1:6, each=6), each-6), c(6,6,6))
x <- array(rep(rep(1:6, each=6), each=6), c(6,6,6))
x
rep(1:6, 36)
rep(1:6, each=36)
rep(rep(1:6), 6), 6)
rep(1:6), 6)
rep(1:6), 6)
cbind(rep(1:6, 36),
rep(rep(1:6, 6), 6)
)
rep(rep(1:6, 6), 6)
rep(1:6, 36)
rep(1:6, each=36)
rep(rep(1:6, 6), 6)
rep(rep(1:6, 6), each=6)
cbind(rep(1:6, each=36),
rep(rep(1:6, 6), each=6),
rep(1:6, 36))
possibilities <- cbind(rep(1:6, each=36),
rep(rep(1:6, 6), each=6),
rep(1:6, 36))
apply(possibilities, 1, sum)
table(apply(possibilities, 1, sum))
probs <- temp/sum(temp)
temp <- table(apply(possibilities, 1, sum))
probs <- temp/sum(temp)
probs
round(probs*100,1)
cumsum(probs)
cumsum(probs[1:length(probs)])
cumsum(probs[length(probs):1])
cumsum(probs[length(probs):1])[1:length(probs)]
cumsum(probs[length(probs):1])[length(probs):1]
plot(3:18, cumprob)
cumprob <- cumsum(probs[length(probs):1])[length(probs):1]
plot(3:18, cumprob, type="b")
(5^2)/12
sqrt((5^2)/12)
sqrt(3*(5^2)/12)
sqrt(8.75)
var(possibilities)
var(apply(possibilities, 1, sum))
sqrt(8.79)
plot(3:18, cumprob, type="b", xlim=c(3,28))
lines(13:28,cumprob, type="b", col="red")
cumprob
possibilities <- cbind(rep(1:12, each=12),
rep(1:12, 12))
possibilities
temp <- table(apply(possibilities, 1, sum))
probs <- temp/sum(temp)
cumprob <- cumsum(probs[length(probs):1])[length(probs):1]
cumprob
barplot(cumprob)
barplot(cumprob)
possibilities <- cbind(rep(1:20, each=20),
rep(1:20, 20))
temp <- table(apply(possibilities, 1, sum))
probs <- temp/sum(temp)
cumprob <- cumsum(probs[length(probs):1])[length(probs):1]
barplot(cumprob)
cumprob
cumprob[15:39]
cumprob[1:25]
cumprob[1:25]/cumprob[15:39]
(p1/(1-p1))/(p2/(1-p2))
p1 <- cumprob[1:25]
p2 <- cumprob[15:39]
(p1/(1-p1))/(p2/(1-p2))
p1 <- cumprob[2:25]
p2 <- cumprob[16:39]
(p1/(1-p1))/(p2/(1-p2))
OR <- (p1/(1-p1))/(p2/(1-p2))
plot(17:40, OR)
plot(17:40, OR, typ="l")
plot(17:40, OR, typ="l", ylim=c(1,200))
cumprob
p2 <- cumprob[6:39]
p2
p1 <- cumprob[2:35]
p2
p1 <- cumprob[2:35]
p2 <- cumprob[6:39]
OR <- (p1/(1-p1))/(p2/(1-p2))
plot(7:40, OR, typ="l", ylim=c(1,200))
OR
barplot(probs)
?barplot
library(ggplot2)
?ggplotGrob
library(ggplot2)
?geom_abline
?Predict
p <- ggplot(mtcars, aes(wt, mpg)) + geom_point()
p + geom_abline()
p + geom_abline(intercept=20)
p + geom_abline(intercept=20, slope=4)
p + geom_abline(intercept=20, slope=-2)
p + geom_abline(intercept=20, slope=-5)
test <- data.frame(intercepts=sample(1:10,5), slopes=-2:2, type=factor(1:5))
test
ggplot(test)
ggplot(test)+geom_abline(intercept=intercepts)
ggplot(test)+geom_abline(intercept=test$intercepts)
ggplot(test)+geom_abline(intercept=test$intercepts, slopes=test$slopes)
library(survey)
?svyolr
setwd("~/Teaching/Classes/SOC512_git_assignments/lab_project")
